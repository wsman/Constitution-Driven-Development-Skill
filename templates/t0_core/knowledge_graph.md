# 工作空间结构 (Knowledge Graph)

**版本**: v6.0.0 (控制论架构正式版，与OpenDoge系统对齐)
**状态**: [🟢 活跃 | 🟡 维护中 | 🔴 重构中]
**项目**: [项目名称]
**最后更新**: [YYYY-MM-DD]
**维护者**: [项目维护者]
**宪法依据**: §101§102§103§148§267-§269
**说明**: [项目名称] 工作空间的知识图谱，提供高层工作空间概述和导航索引。详细文件结构见 T1 公理层。

---

## 📚 文档层级 (T0-T3 架构)

基于宪法驱动开发(CDD)框架，建立四层文档体系：

| 层级 | 名称 | 位置 | 内容 | 加载策略 |
|------|------|------|------|----------|
| **T0** | 核心层 | `MEMORY.md`, `AGENTS.md`, 项目根目录核心文件 | 身份定义、行为准则、总索引 | **常驻** (每次会话加载) |
| **T1** | 公理层 | `memory_bank/t1_axioms/` | 行为模式、系统模式、交互规则 | **按需加载** (AGENTS.md引用) |
| **T2** | 标准层 | `memory_bank/t2_protocols/`, `memory_bank/t2_standards/` | 工作流、任务分解、响应格式 | **延迟加载** (执行时加载) |
| **T3** | 档案层 | `memory/`, `memory_bank/t3_archives/` | 每日记忆、决策日志、历史记录 | **memory_search 查询** |

### T0 核心层文件说明

1. **MEMORY.md** - **总索引**
   - **角色**: `memory_bank/` 的索引文件，包含基本公理摘要和活动上下文
   - **宪法地位**: 单一真理源的顶层索引
   - **大小**: 保持 < 100 行，仅包含索引和摘要

2. **AGENTS.md** - **宪法加载规则**
   - **角色**: 定义宪法驱动开发(CDD)框架和加载规则
   - **宪法地位**: 宪法加载的规则文件
   - **关键内容**: §宪法驱动开发，§宪法加载规则

3. **本项目核心文件** - **项目特定核心**
   - **角色**: 定义项目特定的核心价值观和行为准则
   - **宪法地位**: 身份定义的基础
   - **[项目名称]特定**: [描述项目特定核心文件]

### T1 公理层文件索引

| 文件 | 宪法范围 | 核心内容 | 使用场景 |
|------|----------|----------|----------|
| **behavior_patterns.md** | §400-§499
| **system_patterns.md** | §500-§599
| **entropy_model.md** | §102

**T1文件加载策略**:
1. **按需加载**: 执行特定任务时加载相关公理文件
2. **引用优先**: 优先引用具体条文编号(如§426-§434)
3. **宪法映射**: T0宪法条文在T1层有详细实施说明
4. **层级验证**: 所有T1公理必须符合T0宪法约束

**宪法依据**: §101

---

## 🏛️ 宪法体系结构

### 四层宪法架构

```
┌─────────────────────────────────────┐
│          MEMORY.md (索引)           │ ← T0 核心层
│    - 基本公理摘要 (§101-§113)       │
│    - 活动上下文                     │
│    - memory_bank/ 索引              │
└───────────────┬─────────────────────┘
                │
                ▼
┌─────────────────────────────────────┐
│    memory_bank/t0_core/ (宪法核心)  │ ← T0 详细层
│    - basic_law_index.md (§101-§113) │
│    - knowledge_graph.md (本文件)    │
│    - operational_law_index.md       │
│    - tools_law_index.md             │
└───────────────┬─────────────────────┘
                │
                ▼
┌─────────────────────────────────────┐
│    memory_bank/t1_axioms/ (公理层)  │ ← T1 公理层
│    - behavior_patterns.md           │
│    - system_patterns.md             │
│    - entropy_model.md               │
└───────────────┬─────────────────────┘
                │
                ▼
┌─────────────────────────────────────┐
│ memory_bank/t2_*/ (标准/协议层)     │ ← T2 执行层
│    - WF-* (工作流协议)              │
│    - DS-* (文档标准)                │
└───────────────┬─────────────────────┘
                │
                ▼
┌─────────────────────────────────────┐
│    memory/ (日常档案)               │ ← T3 档案层
│    - YYYY-MM-DD.md                  │
│    - heartbeat_*.log                │
└─────────────────────────────────────┘
```

### 宪法加载规则

**适用于所有会话** (主会话、群聊、共享上下文):
1. **自动参考**: 执行任务时自动考虑相关宪法原则
2. **按需加载**: 复杂决策时显式加载特定宪法文件
3. **宪法检查**: 重大变更前执行宪法合规性验证

### 宪法驱动工作流

```
[任务接收] → [宪法合规检查] → [T1公理层参考] → [T2标准层应用] → [执行决策]
```

---

## ⚖️ 法律编号体系概述

**宪法依据**: §101§102§103

**三层法律体系**:
- **T0 宪法核心层** (§100-§399): 每次会话加载
  - **基本法** (§100-§199): 宪法核心公理，`basic_law_index.md`
  - **操作法** (§200-§299): 程序规范和工作流，`operational_law_index.md`
  - **工具法** (§300-§399): 工具使用宪法，`tools_law_index.md`
- **T1 公理标准层** (§400-§699): 按需加载，详见 T1 公理层文件
- **T2 协议执行层** (无编号): 执行时加载，详见 `memory_bank/t2_*/`

**详细架构**: 法律编号体系的完整说明见 `basic_law_index.md` 中的"法律编号体系架构"部分。

---

## 🏗️ 控制论架构集成

### 控制论架构宪法基础

基于**§148§267-§269

#### 1. 三层控制论架构实现

**宪法实现层次**:
- **[项目名称]治理层 (T0宪法层)**: §148§267-§269
- **控制层 (T1公理层)**: 熵值计算、协同策略、长时间任务执行公理 (§518)
- **执行层 (T2协议层)**: §350-§359

**架构优势**:
| 维度 | 控制论模式（新） | 传统模式（旧） | 提升 |
|------|----------------|--------------|------|
| **复杂度** | L2（中等） | L4（超复杂） | ⬇️ 降低2级 |
| **工时** | 64小时 | 240小时 | ⬇️ 减少73% |
| **实时性** | 高（Colyseus推送） | 中（API轮询） | ⬆️ 毫秒级 |
| **风险** | 低（增量增强） | 高（完全重构） | ⬇️ 降低80% |

#### 2. 三大控制回路宪法实施

**观测回路宪法基础**:
- **§101
- **§102
- **§263-§266
- **知识图谱角色架构**: 观测智能体状态和关系

**控制回路宪法基础**:
- **§267-§269
- **§201-§204
- **§230-§249
- **§518

**记忆回路宪法基础**:
- **持久化原则**: 记忆存储基础
- **§601-§609
- **T3档案层架构**: 记忆分层存储结构
- **四阶段启动模型**: 记忆加载机制

#### 3. 控制论工具宪法标准

**§350-§359
> 控制论工具必须深度集成到宪法体系，遵循观测回路冗余、控制回路降级、记忆回路分阶段实施原则。

**实施要求**:
1. **观测回路冗余**: 关键观测数据必须有冗余备份和验证机制
2. **控制回路降级**: 控制系统必须有优雅降级策略，确保基本功能可用
3. **记忆回路分阶段**: 记忆系统采用分阶段实施策略，优先确保核心记忆完整性
4. **宪法合规验证**: 所有控制论工具使用必须通过宪法合规验证 (§269)

#### 4. 实施进展与路线图

**[项目名称]实施状态**:
- [ ] **宪法化完成**: §148
- [ ] **治理体系建立**: §267-§269
- [ ] **工具标准定义**: §350-§359
- [ ] **技术文档同步**: [项目技术文档路径]

**下一步实施**:
1. **Phase 1**: 控制回路建立 - [描述项目控制回路实施]
2. **Phase 2**: 记忆回路完善 - [描述项目记忆回路实施]
3. **Phase 3**: 观测回路优化 - [描述项目观测回路实施]

#### 5. 宪法引用关系

**完整控制论宪法引用链**:
```
§148
    ↓
§267-§269
    ↓  
§350-§359
    ↓
T1公理层实施 (§518§601-§609
    ↓
T2协议层工具集成 ([项目控制论工具])
```

---

## 📊 关键系统集成

### [项目名称]核心系统架构

**宪法基础**:
- **§101
- **§102
- **§306

**技术栈**:
- **[核心技术1]**: [描述]
- **[核心技术2]**: [描述]
- **[核心技术3]**: [描述]

**[项目名称]架构**:
```
[描述项目架构层次和组件关系]
```

### 熵值监测系统

**宪法基础**: §102

**技术实现**:
- `scripts/measure_entropy.py`: 熵值计算
- `MEMORY.md §当前状态`: 实时熵值展示
- 心跳检查机制: 定期监测

**监测维度**:
- $H_{cog}$: 认知负载
- $H_{struct}$: 结构熵
- $H_{align}$: 对齐偏离

### 多智能体/多成员协作系统

**宪法基础**: AGENTS.md §组织层级与报告

**[项目名称]实施**:
- **协作协调机制**: [描述项目协作机制]
- **权限边界**: [描述项目权限边界]
- **消息队列系统**: [描述项目消息队列]

**组织架构**:
```
[项目决策者]
  └── [项目负责人]
        ├── [执行角色1]
        │      └── (子角色)
        └── [执行角色2]
```

---

## 🔄 维护指南

### 文件更新流程

1. **宪法变更**:
   - 更新 `memory_bank/t0_core/basic_law_index.md`
   - 更新 `MEMORY.md` 中的基本公理摘要
   - 更新相关引用文件

2. **知识图谱变更**:
   - 更新本文件 (`knowledge_graph.md`)
   - 更新 `MEMORY.md` 中的快速参考

3. **脚本更新**:
   - 更新 `scripts/` 中的相关脚本
   - 更新工具说明
   - 更新心跳调用方式

### 宪法一致性检查

每次重大变更后应检查:
1. **引用一致性**: 确保所有宪法文件引用正确
2. **层级完整性**: 确保T0-T3层级结构清晰
3. **实施可行性**: 确保宪法原则有相应的技术实现

### 新模块/功能创建

创建新模块时应:
1. 复制相关模板到新位置
2. 更新本文件中的知识图谱
3. 更新宪法引用 (如需要)
4. 建立必要的消息/队列连接

---

## 📝 变更记录

- **2026-02-20 v6.0.0**: CDD技能模板控制论架构集成版（与OpenDoge系统同步）
  - **模板适配**: 基于OpenDoge知识图谱v6.0.0适配为CDD技能模板
  - **控制论基础**: 集成§148§267-§269
  - **架构集成**: 新增"控制论架构集成"章节，详细说明三大控制回路宪法实施
  - **工具标准**: 集成§350-§359
  - **引用关系**: 建立完整控制论宪法引用链，从§148
  - **变量替换**: 使用 [项目名称] 等模板变量替换具体项目引用
  - **宪法依据**: §101§102§103§148

**文件状态**: [🟢 活跃 | 🟡 维护中 | 🔴 重构中]  
**宪法层级**: T0 宪法核心层  
**加载策略**: 每次会话开始时加载  
**下次审查**: [YYYY-MM-DD]

*宪法即秩序，秩序即真理。精简即熵减，熵减即生存。*